# Octoprint dashboard
title: Octoprint dashboard
icon: mdi:printer-3d
panel: true
path: octo-pi
background: "right/auto linear-gradient(23deg, rgba(211,211,211,1) 0%, rgba(223,223,223,1) 34%, rgba(255,255,255,1) 100%)"

cards:  
  - type: vertical-stack
    cards:
      - type: custom:layout-card
        layout: vertical
        cards:
          - type: vertical-stack
            cards:
              - type: glance
                title: 3D printer state
                show_header_toggle: false
                entities:
                  - name: Printer state 
                    entity: sensor.octoprint_current_state
                    icon: mdi:printer-3d
                    state_color: true
                  - name: Printing 
                    entity: binary_sensor.octoprint_printing
                    icon: mdi:printer-3d-nozzle
                    state_color: true
                  - name: Error
                    entity: binary_sensor.octoprint_printing_error
                    icon: mdi:printer-3d-nozzle-alert
                    style: |
                      :host {
                        {% if states('binary_sensor.octoprint_printing_error') == 'off' %}
                          --paper-item-icon-color: #1bb544;
                          # color: #1bb544;
                        {% elif states('binary_sensor.octoprint_printing_error') == 'on' %}
                          --paper-item-icon-color: #f00a0a;
                          # color: #f00a0a;
                        {% endif %}
                      }
              # - cards: 
              #   type: horizontal-stack    
                          
                    
              - type: picture-glance
                title: Webcam
                entities: 
                  - camera.octoprint
                camera_image: camera.octoprint

          #######
          - type: custom:layout-break
          #######

          - type: vertical-stack
            cards:
              - type: custom:bar-card
                title: Print progress
                show_header_toggle: false
                entity: sensor.octoprint_job_percentage 
                color: "green"
              - type: entities
                show_header_toggle: false
                entities:
                  - entity: sensor.octoprint_current_filename  
                    name: File name             
                    icon: mdi:rename-box
                  - entity: sensor.octoprint_start_time
                    name: Start time        
                    icon: mdi:clock-start
                  - entity: sensor.octoprint_estimated_finish_time
                    name: Finish time
                    icon: mdi:clock-end
              - type: conditional
                conditions:
                  - entity: binary_sensor.octoprint_printing
                    state: "on"
                card:
                  type: picture-glance
                  title: Preview
                  entities: []
                  camera_image: camera.octoprint_preview

          #######
          - type: custom:layout-break
          ####### 

          - type: entities
            title: Print control
            entities:
            - card:
                entity: switch.attic_3d_printer
                name: Printer on/off 
                state_color: true
              restrictions:
                block: true
              condition:
                value: 'on'
                entity: binary_sensor.octoprint_printing
              type: 'custom:restriction-card'
              row: true                                 
            - entity: sensor.attic_3d_printer_power
              name: Printer power

          # Bed temperature
          - type: custom:apexcharts-card
            locale: 'nl'
            hours_12: false
            header:
              title: Bed/tool temperature
              show: true
              # show_states: true
              colorize_states: true
              # standard_format: true
            experimental:
              brush: true 
            graph_span: 2h 
            brush:
              selection_span: 2h
            apex_config:
              yaxis:
                forceNiceScale: true
                # min: 0
                # max: 4
            series:
              # Tool
              - entity: sensor.octoprint_actual_tool0_temp
                name: 'Actual T'
                color: red
                opacity: 0.1
                type: area
                stroke_width: 1
                float_precision: 0
                show:
                  name_in_header: true
              - entity: sensor.octoprint_target_tool0_temp
                name: 'Target T'
                color: orange
                opacity: 0.1
                type: area
                stroke_width: 1
                float_precision: 0
                show:
                  name_in_header: true     

              # Bed
              - entity: sensor.octoprint_actual_bed_temp
                name: 'Actual B'
                color: blue
                opacity: 0.1
                type: area
                stroke_width: 1
                float_precision: 0
                show:
                  name_in_header: true
              - entity: sensor.octoprint_target_bed_temp
                name: 'Target B'
                color: purple
                opacity: 0.1
                type: area
                stroke_width: 1
                float_precision: 0
                show:
                  name_in_header: true     

              # slider                          
              - entity: sensor.octoprint_actual_tool0_temp
                color: green         
                opacity: 0.5
                stroke_width: 2
                float_precision: 0
                type: area
                show:
                  # in_brush: set it to true and the serie will show up in the brush
                  in_brush: true
                  # add this also if you want your serie to only show up in the brush
                  in_chart: false
